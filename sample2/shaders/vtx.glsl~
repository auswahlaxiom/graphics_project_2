#version 400

layout(location=0) in vec3 coord;  
layout(location=1) in vec3 normal; 
 
noperspective out float NdotL; 

uniform mat4 MV; 
uniform mat4 P; 
uniform mat3 N; 
uniform vec3 lloc; 
 
void main() {  
  vec4 WorldCoord = MV * vec4(coord,1.0);   
  vec3 L = normalize(lloc - WorldCoord.xyz);   
  vec3 WorldNormal = N*normal;               
  vec3 N = normalize(WorldNormal);                  
  NdotL = dot(N,L);                                   
  gl_Position = P*WorldCoord;           
} 
